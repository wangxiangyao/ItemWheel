<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.2.8 Chrome/140.0.7339.240 Electron/38.4.0 Safari/537.36" version="28.2.8">
  <diagram name="QuickWheelå®Œæ•´æž¶æž„å›¾" id="å®Œæ•´æž¶æž„åˆ†æž">
    <mxGraphModel dx="2000" dy="1200" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- IWheelInputHandler æŽ¥å£ -->
        <mxCell id="inputHandlerInterface" value="IWheelInputHandler (æŽ¥å£)&#xa;&#xa;ðŸ“‹ äº‹ä»¶ï¼š&#xa;â€¢ Action&lt;Vector2&gt; OnPositionChanged&#xa;â€¢ Action OnConfirm&#xa;â€¢ Action OnCancel&#xa;&#xa;ðŸ”§ æ–¹æ³•ï¼š&#xa;â€¢ void OnUpdate()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="50" width="180" height="140" as="geometry" />
        </mxCell>

        <!-- MouseWheelInput å®žçŽ° -->
        <mxCell id="mouseWheelInput" value="MouseWheelInput (å®žçŽ°)&#xa;&#xa;ðŸ”§ å­—æ®µï¼š&#xa;â€¢ KeyCode _triggerKey&#xa;â€¢ bool _isPressed&#xa;&#xa;ðŸ“‹ äº‹ä»¶ï¼šç»§æ‰¿æŽ¥å£&#xa;ðŸ”§ æ–¹æ³•ï¼š&#xa;â€¢ OnUpdate() - æ£€æµ‹æŒ‰é”®çŠ¶æ€&#xa;â€¢ Reset() - é‡ç½®çŠ¶æ€" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#b3d8ff;strokeColor=#4d7fc3;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="50" y="240" width="180" height="160" as="geometry" />
        </mxCell>

        <!-- IWheelSelectionStrategy æŽ¥å£ -->
        <mxCell id="strategyInterface" value="IWheelSelectionStrategy (æŽ¥å£)&#xa;&#xa;ðŸ”§ æ–¹æ³•ï¼š&#xa;â€¢ int GetSelectedIndex(&#xa;  WheelSelectionContext context)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="880" y="50" width="200" height="80" as="geometry" />
        </mxCell>

        <!-- WheelSelectionContext ä¸Šä¸‹æ–‡ -->
        <mxCell id="context" value="WheelSelectionContext&#xa;&#xa;ðŸ“‹ å±žæ€§ï¼š&#xa;â€¢ Vector2 InputPosition&#xa;â€¢ Vector2 WheelCenter&#xa;â€¢ WheelConfig Config&#xa;â€¢ int SlotCount (åªè¯»)&#xa;â€¢ float DeadZoneRadius (åªè¯»)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="880" y="180" width="200" height="120" as="geometry" />
        </mxCell>

        <!-- GridSelectionStrategy å®žçŽ° -->
        <mxCell id="gridStrategy" value="GridSelectionStrategy (å®žçŽ°)&#xa;&#xa;ðŸ”§ å­—æ®µï¼š&#xa;â€¢ const int GRID_SLOT_COUNT = 9&#xa;â€¢ static float[] DIRECTION_ANGLES&#xa;&#xa;ðŸ”§ æ–¹æ³•ï¼š&#xa;â€¢ GetSelectedIndex() - è§’åº¦è®¡ç®—&#xa;â€¢ IsInDeadZone() - æ­»åŒºæ£€æµ‹&#xa;â€¢ GetDirectionIndexFromAngle()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffd966;strokeColor=#d6b656;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="880" y="360" width="200" height="180" as="geometry" />
        </mxCell>

        <!-- Wheel<T> æ ¸å¿ƒ -->
        <mxCell id="wheel" value="Wheel&lt;T&gt; (è½®ç›˜æ ¸å¿ƒ)&#xa;&#xa;ðŸ“‹ äº‹ä»¶ï¼š&#xa;â€¢ Action&lt;int, T&gt; OnItemSelected&#xa;â€¢ Action OnWheelShown&#xa;â€¢ Action&lt;int&gt; OnWheelHidden&#xa;&#xa;ðŸ”§ ä¸»è¦æ–¹æ³•ï¼š&#xa;â€¢ SetInputHandler()&#xa;â€¢ SetSelectionStrategy()&#xa;â€¢ SetView()&#xa;â€¢ Show() / Hide()&#xa;â€¢ Update() - è°ƒç”¨InputHandler&#xa;â€¢ ManualSetHover()&#xa;â€¢ GetHoveredIndex()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="440" y="200" width="220" height="200" as="geometry" />
        </mxCell>

        <!-- å…³é”®æ–¹æ³• HandleInputPositionChanged -->
        <mxCell id="handleInput" value="ðŸ”§ HandleInputPositionChanged()&#xa;&#xa;æµç¨‹ï¼š&#xa;1. æ£€æŸ¥çŠ¶æ€ (Active?)&#xa;2. åˆ›å»ºWheelSelectionContext&#xa;3. è°ƒç”¨SelectionStrategy&#xa;4. æ›´æ–°HoveredIndex&#xa;5. è§¦å‘SlotHoveredäº‹ä»¶" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e6ffcc;strokeColor=#82b366;fontSize=10;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="450" width="260" height="120" as="geometry" />
        </mxCell>

        <!-- IWheelView<T> æŽ¥å£ -->
        <mxCell id="viewInterface" value="IWheelView&lt;T&gt; (æŽ¥å£)&#xa;&#xa;ðŸ”§ æ–¹æ³•ï¼š&#xa;â€¢ Attach/Detach&#xa;â€¢ Vector2 GetWheelCenter() âœ¨æ–°å¢ž&#xa;â€¢ OnWheelShown/OnWheelHidden&#xa;â€¢ OnSlotDataChanged&#xa;â€¢ OnSelectionChanged&#xa;â€¢ OnHoverChanged" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="440" y="20" width="220" height="140" as="geometry" />
        </mxCell>

        <!-- DefaultWheelView<T> å®žçŽ° -->
        <mxCell id="defaultView" value="DefaultWheelView&lt;T&gt; (å®žçŽ°)&#xa;&#xa;ðŸ”§ å­—æ®µï¼š&#xa;â€¢ Transform _parent&#xa;â€¢ WheelUIManager&lt;T&gt; _uiManager&#xa;&#xa;ðŸ”§ æ–¹æ³•ï¼š&#xa;â€¢ GetWheelCenter() - è¿”å›žé¼ æ ‡ä½ç½®âœ¨&#xa;â€¢ Attach/Detach - UIç®¡ç†å™¨ç”Ÿå‘½å‘¨æœŸ&#xa;â€¢ OnWheelShown/OnWheelHidden - æ˜¾ç¤ºéšè—" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6d5f0;strokeColor=#9673a6;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="440" y="620" width="220" height="160" as="geometry" />
        </mxCell>

        <!-- WheelUIManager<T> -->
        <mxCell id="uiManager" value="WheelUIManager&lt;T&gt;&#xa;&#xa;ðŸ”§ å­—æ®µï¼š&#xa;â€¢ Canvas _wheelCanvas&#xa;â€¢ List&lt;WheelSlotDisplay&gt; _slotDisplays&#xa;â€¢ static Vector2Int[] GRID_POSITIONS&#xa;&#xa;ðŸ”§ æ–¹æ³•ï¼š&#xa;â€¢ Show() - æ˜¾ç¤ºåœ¨Input.mousePosition&#xa;â€¢ Hide() - éšè—è½®ç›˜&#xa;â€¢ UpdateSelection() - æ›´æ–°é€‰ä¸­çŠ¶æ€" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="700" y="620" width="200" height="180" as="geometry" />
        </mxCell>

        <!-- ItemWheelSystem -->
        <mxCell id="itemwheel" value="ItemWheelSystem (ä¸šåŠ¡ç³»ç»Ÿ)&#xa;&#xa;ðŸ”§ å­—æ®µï¼š&#xa;â€¢ Dictionary&lt;ItemWheelCategory, CategoryWheel&gt; _wheels&#xa;â€¢ CharacterMainControl _character&#xa;â€¢ CategoryWheel _activeWheel&#xa;&#xa;ðŸ”§ æ–¹æ³•ï¼š&#xa;â€¢ Update() - è½®ç›˜æ›´æ–°é€»è¾‘&#xa;â€¢ TryShowWheel() - æ˜¾ç¤ºæŒ‡å®šç±»åˆ«è½®ç›˜&#xa;â€¢ ConfirmActiveWheelSelection()&#xa;â€¢ CancelActiveWheel()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcccc;strokeColor=#cc0000;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="50" y="460" width="200" height="180" as="geometry" />
        </mxCell>

        <!-- WheelBuilder<T> -->
        <mxCell id="builder" value="WheelBuilder&lt;T&gt;&#xa;&#xa;ðŸ”§ é“¾å¼æ–¹æ³•ï¼š&#xa;â€¢ WithConfig()&#xa;â€¢ WithAdapter()&#xa;â€¢ WithInput() - InputHandlerâœ¨&#xa;â€¢ WithSelectionStrategy()&#xa;â€¢ WithView()&#xa;â€¢ OnItemSelected/OnWheelShown/OnWheelHidden&#xa;â€¢ Build()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#cce5ff;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="280" y="20" width="180" height="180" as="geometry" />
        </mxCell>

        <!-- äº‹ä»¶æµæ ‡æ³¨ -->
        <mxCell id="eventFlow1" value="ðŸ”´ äº‹ä»¶æµ1ï¼šè¾“å…¥å¤„ç†" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="680" width="140" height="30" as="geometry" />
        </mxCell>

        <mxCell id="eventFlow2" value="ðŸ”´ äº‹ä»¶æµ2ï¼šé€‰æ‹©é€»è¾‘" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="460" y="590" width="140" height="30" as="geometry" />
        </mxCell>

        <mxCell id="eventFlow3" value="ðŸ”´ äº‹ä»¶æµ3ï¼šUIæ›´æ–°" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="720" y="820" width="140" height="30" as="geometry" />
        </mxCell>

        <!-- è¿žæŽ¥çº¿ - è¾“å…¥æµ -->
        <mxCell id="edgeInput1" value="OnPositionChanged" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="mouseWheelInput" target="wheel" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="240" y="320" />
              <mxPoint x="440" y="320" />
            </Array>
            <mxPoint x="350" y="280" as="offset" />
          </mxGeometry>
        </mxCell>

        <mxCell id="edgeInput2" value="OnConfirm/OnCancel" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="mouseWheelInput" target="wheel" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="140" y="410" />
              <mxPoint x="140" y="450" />
              <mxPoint x="380" y="450" />
            </Array>
            <mxPoint x="300" y="360" as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- è¿žæŽ¥çº¿ - é€‰æ‹©ç­–ç•¥æµ -->
        <mxCell id="edgeStrategy1" value="ä½¿ç”¨context" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="handleInput" target="gridStrategy" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="690" y="510" />
              <mxPoint x="880" y="510" />
            </Array>
            <mxPoint x="790" y="480" as="offset" />
          </mxGeometry>
        </mxCell>

        <mxCell id="edgeStrategy2" value="åŒ…å«" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;dashed=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="strategyInterface" target="context" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edgeStrategy3" value="å®žçŽ°" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;dashed=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="context" target="gridStrategy" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- è¿žæŽ¥çº¿ - Viewæµ -->
        <mxCell id="edgeView1" value="GetWheelCenter" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="handleInput" target="defaultView" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="550" y="510" as="offset" />
          </mxGeometry>
        </mxCell>

        <mxCell id="edgeView2" value="å®žçŽ°" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;dashed=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="viewInterface" target="defaultView" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="edgeView3" value="ä½¿ç”¨" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;dashed=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="defaultView" target="uiManager" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- è¿žæŽ¥çº¿ - ItemWheelæµ -->
        <mxCell id="edgeItemWheel1" value="ä½¿ç”¨WheelBuilderåˆ›å»º" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;dashed=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="itemwheel" target="wheel" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="260" y="550" />
              <mxPoint x="350" y="550" />
              <mxPoint x="350" y="300" />
              <mxPoint x="440" y="300" />
            </Array>
            <mxPoint x="350" y="420" as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- è¿žæŽ¥çº¿ - Builderæµ -->
        <mxCell id="edgeBuilder1" value="é…ç½®" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;dashed=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="builder" target="wheel" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="370" y="110" as="offset" />
          </mxGeometry>
        </mxCell>

        <!-- é—®é¢˜æ ‡æ³¨ -->
        <mxCell id="problemFixed" value="âœ… å·²ä¿®å¤ï¼š&#xa;1. HandleInputPositionChangedå·²å®žçŽ°&#xa;2. IWheelViewæ·»åŠ äº†GetWheelCenter()&#xa;3. DefaultWheelViewå®žçŽ°äº†GetWheelCenter()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="740" width="200" height="80" as="geometry" />
        </mxCell>

        <mxCell id="pendingQuestion" value="ðŸ¤” å¾…è§£å†³ï¼š&#xa;InputHandlerçš„è®¾è®¡æ„ä¹‰ï¼Ÿ&#xa;å¦‚ä½•ä¸ŽItemWheelçš„è¾“å…¥ç³»ç»Ÿé›†æˆï¼Ÿ" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="280" y="740" width="200" height="60" as="geometry" />
        </mxCell>

        <mxCell id="selectionBug" value="ðŸ› é€‰æ‹©Bugï¼š&#xa;GridSelectionStrategyä¸Šä¸‹åè½¬&#xa;(Yè½´åæ ‡ç³»é—®é¢˜)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffcccc;strokeColor=#cc0000;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="1120" y="400" width="160" height="60" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>